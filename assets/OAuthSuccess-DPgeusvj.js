import{r as d,o as m,u as g,a as n,b as h,c as k,d as p,e as i,f}from"./index-D_MvzuAN.js";const w={class:"flex items-center justify-center h-screen text-xl text-white"},O={__name:"OAuthSuccess",setup(S){const o=k(),r=g(),u=d([]),e=t=>{u.value.push(`[${new Date().toLocaleTimeString()}] ${t}`),console.log("[OAuthSuccess]",t)};return m(async()=>{e("OAuthSuccess mounted");try{e("--- OAuth Debug Start ---");const t=typeof r?.query?.token=="string"?r.query.token:null;e(`Token from route.query: ${t?"YES":"NO"}`);const c=new URLSearchParams(window.location.search).get("token");e(`Token from window.location.search: ${c?"YES":"NO"}`);const s=t||c;if(e(`Final token decision: ${s?"YES":"NO"}`),s){e("Setting token in localStorage..."),await n.setToken(s),e("Fetching user data...");const{data:l}=await h.get("https://zgram.mooo.com/api/auth/user");e("User data received"),await n.setUser(l),e("Redirecting to home..."),await o.replace("/")}else e("No token found, redirecting to login..."),o.replace("/login");e("--- OAuth Debug End ---")}catch(t){e(`Error: ${t.message}`),await n.clearToken(),o.replace("/login")}}),(t,a)=>(f(),p("div",w,[...a[0]||(a[0]=[i("div",{class:"text-center"},[i("div",{class:"mb-4"},"Loading...")],-1)])]))}};export{O as default};
